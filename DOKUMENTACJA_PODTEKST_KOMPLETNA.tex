\documentclass[a4paper,11pt]{article}

% ============================================================
% Packages
% ============================================================
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[polish]{babel}
\usepackage{geometry}
\geometry{margin=2cm}
\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=blue!60!black,
  urlcolor=blue!60!black,
  pdftitle={PodTeksT ‚Äî Kompletna Dokumentacja Funkcji},
  pdfauthor={Claude Opus 4.6},
}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{tabularx}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{amsmath}

% ============================================================
% Custom colors
% ============================================================
\definecolor{ptblue}{HTML}{3B82F6}
\definecolor{ptpurple}{HTML}{A855F7}
\definecolor{ptgreen}{HTML}{10B981}
\definecolor{ptred}{HTML}{EF4444}
\definecolor{ptyellow}{HTML}{F59E0B}
\definecolor{ptbg}{HTML}{0A0A0A}
\definecolor{ptcard}{HTML}{111111}

% ============================================================
% Header/Footer
% ============================================================
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\footnotesize\textcolor{gray}{PodTeksT ‚Äî Dokumentacja Funkcji}}
\fancyhead[R]{\footnotesize\textcolor{gray}{v2.0 | Faza 24}}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}

% ============================================================
% Title formatting
% ============================================================
\titleformat{\section}{\Large\bfseries\color{ptblue}}{\thesection}{1em}{}
\titleformat{\subsection}{\large\bfseries\color{ptpurple}}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\normalsize\bfseries}{\thesubsubsection}{1em}{}

% ============================================================
% Document
% ============================================================
\begin{document}

% ============================================================
% Title Page
% ============================================================
\begin{titlepage}
\centering
\vspace*{4cm}

{\Huge\bfseries\textcolor{ptblue}{Pod}\textcolor{ptpurple}{Teks}\textcolor{ptblue}{T}}

\vspace{0.8cm}
{\large\itshape odkryj to, co kryje siƒô miƒôdzy wierszami}

\vspace{2cm}
{\LARGE\bfseries Kompletna Dokumentacja Funkcji}

\vspace{0.5cm}
{\large Wszystkie funkcje, metryki, zakresy i algorytmy}

\vspace{3cm}

\begin{tabular}{rl}
  \textbf{Wersja:} & 2.0 (Faza 24) \\
  \textbf{Data:} & \today \\
  \textbf{AI Development:} & Claude Opus 4.6 \\
  \textbf{AI Analysis:} & Gemini 3 Flash Preview \\
  \textbf{Stack:} & Next.js 16+, TypeScript, Tailwind v4 \\
\end{tabular}

\vfill
{\footnotesize Wygenerowano automatycznie na podstawie kodu ≈∫r√≥d≈Çowego}
\end{titlepage}

% ============================================================
% Table of Contents
% ============================================================
\tableofcontents
\newpage

% ============================================================
% 1. WPROWADZENIE
% ============================================================
\section{Wprowadzenie}

\textbf{PodTeksT} to aplikacja webowa analizujƒÖca eksporty rozm√≥w z~komunikator√≥w. U≈ºytkownik wgrywa plik eksportu, a~aplikacja oblicza \textbf{80+ metryk ilo≈õciowych} (client-side, bez AI) oraz przeprowadza \textbf{wieloprzebiegowƒÖ analizƒô psychologicznƒÖ AI} (server-side, Gemini API).

\subsection{Obs≈Çugiwane platformy}
\begin{itemize}[nosep]
  \item Facebook Messenger (JSON)
  \item WhatsApp (TXT)
  \item Instagram DM (JSON)
  \item Telegram (JSON)
  \item Discord (API ‚Äî import przez bota)
\end{itemize}

\subsection{Architektura}
\begin{itemize}[nosep]
  \item \textbf{Parsing + analiza ilo≈õciowa:} Client-side (przeglƒÖdarka) ‚Äî surowe wiadomo≈õci nigdy nie opuszczajƒÖ urzƒÖdzenia
  \item \textbf{Analiza jako≈õciowa AI:} Server-side API routes ‚Äî wysy≈Çane 200--500 pr√≥bkowanych wiadomo≈õci per przebieg
  \item \textbf{Przechowywanie danych:} IndexedDB + localStorage (lokalne, bez serwera)
  \item \textbf{Streaming:} SSE (Server-Sent Events) z heartbeatem co 15s
\end{itemize}

% ============================================================
% 2. ANALIZA ILO≈öCIOWA
% ============================================================
\section{Analiza ilo≈õciowa (80+ metryk)}

Wszystkie metryki w~tej sekcji sƒÖ obliczane \textbf{wy≈ÇƒÖcznie po stronie klienta}, bez udzia≈Çu AI. Obliczenia wykonywane w~jednym przebiegu $O(n)$ przez modu≈Ç \texttt{quantitative.ts}.

% ---- 2.1 Per-person ----
\subsection{Statystyki podstawowe (per osoba)}

\begin{longtable}{p{4.5cm}p{6cm}p{3cm}}
\toprule
\textbf{Metryka} & \textbf{Opis} & \textbf{Typ / Zakres} \\
\midrule
\endhead
totalMessages & Ca≈Çkowita liczba wiadomo≈õci & \texttt{number} $\geq 0$ \\
totalWords & Ca≈Çkowita liczba s≈Ç√≥w & \texttt{number} $\geq 0$ \\
avgWordsPerMessage & ≈örednia s≈Ç√≥w na wiadomo≈õƒá & \texttt{number} $\geq 0$ \\
longestMessage & Najd≈Çu≈ºsza wiadomo≈õƒá (s≈Çowa) & \texttt{number} $\geq 0$ \\
shortestMessage & Najkr√≥tsza wiadomo≈õƒá (s≈Çowa) & \texttt{number} $\geq 1$ \\
questionCount & Liczba pyta≈Ñ (znaki ?) & \texttt{number} $\geq 0$ \\
questionRatio & Odsetek pyta≈Ñ & \texttt{number} 0--1 \\
exclamationCount & Liczba wykrzyknik√≥w & \texttt{number} $\geq 0$ \\
mediaCount & Multimedia (zdjƒôcia, video, GIF, stickery, audio, pliki) & \texttt{number} $\geq 0$ \\
reactionsSent & Reakcje wys≈Çane & \texttt{number} $\geq 0$ \\
reactionsReceived & Reakcje otrzymane & \texttt{number} $\geq 0$ \\
reactionGiveRate & Rate reakcji dawanych & \texttt{number} 0--1 \\
reactionReceiveRate & Rate reakcji otrzymywanych & \texttt{number} 0--1 \\
deletedMessages & Usuniƒôte wiadomo≈õci & \texttt{number} $\geq 0$ \\
editedMessages & Edytowane wiadomo≈õci & \texttt{number} $\geq 0$ \\
firstMessageDate & Data pierwszej wiadomo≈õci & \texttt{Date} \\
lastMessageDate & Data ostatniej wiadomo≈õci & \texttt{Date} \\
activeDays & Unikalne dni aktywno≈õci & \texttt{number} $\geq 1$ \\
topEmojis & Top 10 emoji per osoba & \texttt{[emoji, count][]} \\
topWords & Top 20 najczƒôstszych s≈Ç√≥w & \texttt{[word, count][]} \\
topPhrases & Top 10 fraz (2--4 s≈Çowa) & \texttt{[phrase, count][]} \\
\bottomrule
\end{longtable}

% ---- 2.2 Timing ----
\subsection{Timing i czasy odpowiedzi}

\begin{longtable}{p{5cm}p{5.5cm}p{3cm}}
\toprule
\textbf{Metryka} & \textbf{Opis} & \textbf{Typ / Zakres} \\
\midrule
\endhead
medianResponseTimeMs & Mediana czasu odpowiedzi (ms) & \texttt{number} $\geq 0$ \\
avgResponseTimeMs & ≈öredni czas odpowiedzi (ms) & \texttt{number} $\geq 0$ \\
fastestResponseMs & Najszybsza odpowied≈∫ (ms) & \texttt{number} $\geq 0$ \\
slowestResponseMs & Najwolniejsza odpowied≈∫ (ms) & \texttt{number} $\geq 0$ \\
responseTimes[] & Tablica surowych czas√≥w & \texttt{number[]} (ms) \\
conversationInitiations & Ile razy zainicjowa≈Ç rozmowƒô & \texttt{number} $\geq 0$ \\
conversationInitiationRatio & Odsetek inicjacji & \texttt{number} 0--1 \\
longestSilence & Najd≈Çu≈ºsza cisza & \texttt{object} \\
\quad .durationMs & Czas trwania (ms) & \texttt{number} \\
\quad .startDate / endDate & Okres ciszy & \texttt{Date} \\
\quad .beforeSender / afterSender & Kto pisa≈Ç przed/po & \texttt{string} \\
doubleTextRate & Odsetek podw√≥jnych wiadomo≈õci & \texttt{number} 0--1 \\
doubleTextCount & Liczba double-text√≥w & \texttt{number} $\geq 0$ \\
\bottomrule
\end{longtable}

\subsubsection{Dystrybucja czas√≥w odpowiedzi (Response Time Distribution)}
Czasy odpowiedzi binowane w~8 kube≈Çk√≥w:

\begin{center}
\begin{tabular}{cl}
\toprule
\textbf{Bin} & \textbf{Zakres} \\
\midrule
1 & $< 10$ sekund \\
2 & 10--30 sekund \\
3 & 30s -- 1 minuta \\
4 & 1--5 minut \\
5 & 5--15 minut \\
6 & 15--30 minut \\
7 & 30 min -- 1 godzina \\
8 & $> 1$ godziny \\
\bottomrule
\end{tabular}
\end{center}

% ---- 2.3 Engagement ----
\subsection{Zaanga≈ºowanie (Engagement)}

\begin{longtable}{p{5cm}p{5.5cm}p{3cm}}
\toprule
\textbf{Metryka} & \textbf{Opis} & \textbf{Typ / Zakres} \\
\midrule
\endhead
engagementScore & Wa≈ºony wynik zaanga≈ºowania & \texttt{number} 0--100 \\
consistencyScore & Sta≈Ço≈õƒá aktywno≈õci (std dev) & \texttt{number} $\geq 0$ \\
messageRatio & Stosunek wiadomo≈õci per osoba & \texttt{number} 0--1 \\
reactionRate & Rate reaktywno≈õci & \texttt{number} 0--1 \\
doubleTexts & Podw√≥jne wiadomo≈õci & \texttt{Record<string, number>} \\
maxConsecutive & Max kolejnych wiadomo≈õci & \texttt{Record<string, number>} \\
avgConversationLength & ≈ör. d≈Çugo≈õƒá rozmowy & \texttt{number} \\
totalSessions & Liczba sesji (przerwa > 6h) & \texttt{number} \\
lateNightRatio & Odsetek wiadomo≈õci 0:00--5:00 & \texttt{number} 0--1 \\
weekendRatio & Odsetek wiadomo≈õci weekend & \texttt{number} 0--1 \\
\bottomrule
\end{longtable}

% ---- 2.4 Heatmap ----
\subsection{Heatmapa aktywno≈õci}

\begin{itemize}[nosep]
  \item \textbf{Combined Heatmap:} Macierz $7 \times 24$ (dzie≈Ñ tygodnia $\times$ godzina), zsumowana po wszystkich uczestnikach
  \item \textbf{Per-person Heatmap:} Oddzielna macierz $7 \times 24$ dla ka≈ºdego uczestnika
  \item \textbf{24-Hour Activity Chart:} Agregacja per godzina (0--23), stacked per osoba
\end{itemize}

% ---- 2.5 Trends ----
\subsection{Trendy miesiƒôczne}

\begin{longtable}{p{5cm}p{5.5cm}p{3cm}}
\toprule
\textbf{Trend} & \textbf{Opis} & \textbf{Format} \\
\midrule
\endhead
responseTimeTrend & Mediana czasu odpowiedzi/miesiƒÖc & \texttt{[month, perPerson]} \\
messageLengthTrend & Mediana d≈Çugo≈õci wiadomo≈õci/miesiƒÖc & \texttt{[month, perPerson]} \\
initiationTrend & Inicjacje rozm√≥w/miesiƒÖc & \texttt{[month, perPerson]} \\
monthlyVolume & Wolumen wiadomo≈õci/miesiƒÖc & \texttt{[month, perPerson, total]} \\
sentimentTrend & Trend sentymentu/miesiƒÖc & \texttt{[month, perPerson]} \\
volumeTrend & Kierunek zmiany wolumenu & \texttt{growing/declining/stable} \\
\bottomrule
\end{longtable}

\subsubsection{Year Milestones}
Obliczane z~\texttt{monthlyVolume}:
\begin{itemize}[nosep]
  \item \textbf{peakMonth:} MiesiƒÖc z~najwiƒôkszƒÖ liczbƒÖ wiadomo≈õci (nazwa PL + count)
  \item \textbf{worstMonth:} MiesiƒÖc z~najmniejszƒÖ liczbƒÖ wiadomo≈õci
  \item \textbf{yoyTrend:} Zmiana rok-do-roku: $\frac{\text{suma nowsza po≈Çowa}}{\text{suma starsza po≈Çowa}} - 1$ (warto≈õƒá procentowa)
\end{itemize}

% ---- 2.6 Sentiment ----
\subsection{Analiza sentymentu}

Obliczana per osoba na podstawie s≈Çownika pozytywnych/negatywnych s≈Ç√≥w:

\begin{longtable}{p{4.5cm}p{5.5cm}p{3.5cm}}
\toprule
\textbf{Metryka} & \textbf{Opis} & \textbf{Zakres} \\
\midrule
\endhead
positiveRatio & Odsetek pozytywnych wiadomo≈õci & 0--1 \\
negativeRatio & Odsetek negatywnych wiadomo≈õci & 0--1 \\
neutralRatio & Odsetek neutralnych & 0--1 \\
volatility & Zmienno≈õƒá emocjonalna (std dev) & $\geq 0$ \\
dominantTone & DominujƒÖcy ton & \texttt{string} \\
\bottomrule
\end{longtable}

% ---- 2.7 Conflicts ----
\subsection{Wykrywanie konflikt√≥w}

Konflikty identyfikowane na podstawie nagromadzenia negatywnych s≈Ç√≥w kluczowych, kr√≥tkich gniewnych odpowiedzi i~eskalacji wzorc√≥w. Ka≈ºdy konflikt zawiera:
\begin{itemize}[nosep]
  \item Timestamp konfliktu
  \item Uczestnicy
  \item Severity (niski/≈õredni/wysoki)
  \item S≈Çowa-wyzwalacze
\end{itemize}

% ---- 2.8 Intimacy ----
\subsection{Progresja intymno≈õci}

Miesiƒôczny wynik intymno≈õci (0--100) obliczany z~kombinacji:
\begin{itemize}[nosep]
  \item D≈Çugo≈õƒá wiadomo≈õci (d≈Çu≈ºsze = bardziej intymne)
  \item Aktywno≈õƒá nocna (late-night sharing)
  \item Czƒôstotliwo≈õƒá i~czas odpowiedzi
  \item Wzajemno≈õƒá (reciprocity)
\end{itemize}
Fazy: \texttt{casual} $\rightarrow$ \texttt{deepening} $\rightarrow$ \texttt{intimate}

% ---- 2.9 Pursuit-Withdrawal ----
\subsection{Pursuit-Withdrawal Detection}

Wykrywanie cyklicznych wzorc√≥w pogoni i~wycofania:

\begin{itemize}[nosep]
  \item \textbf{Pursuit:} 3+ kolejnych wiadomo≈õci od tej samej osoby w~oknie $< 30$ minut
  \item \textbf{Withdrawal:} Nastƒôpna odpowied≈∫ po $> 2$ godzinach ciszy
  \item \textbf{Wymagane:} Minimum 2 cykle do identyfikacji wzorca
\end{itemize}

Wynik:
\begin{longtable}{p{4.5cm}p{5.5cm}p{3.5cm}}
\toprule
\textbf{Pole} & \textbf{Opis} & \textbf{Typ} \\
\midrule
\endhead
pursuer & Kto goni & \texttt{string} \\
withdrawer & Kto siƒô wycofuje & \texttt{string} \\
cycleCount & Liczba wykrytych cykli & \texttt{number} $\geq 2$ \\
avgCycleDurationMs & ≈öredni czas wycofania & \texttt{number} (ms) \\
escalationTrend & Trend eskalacji & \texttt{number} ($>0$ = pogarsza siƒô) \\
\bottomrule
\end{longtable}

% ---- 2.10 Reciprocity ----
\subsection{Indeks wzajemno≈õci (Reciprocity Index)}

Kompozytowy wynik 0--1 z~4 sk≈Çadnik√≥w:
\[
\text{RI} = 0.3 \cdot r_{\text{msg}} + 0.25 \cdot r_{\text{word}} + 0.25 \cdot r_{\text{init}} + 0.2 \cdot r_{\text{rt}}
\]
gdzie:
\begin{itemize}[nosep]
  \item $r_{\text{msg}}$ ‚Äî stosunek wiadomo≈õci (bli≈ºej 0.5 = lepiej)
  \item $r_{\text{word}}$ ‚Äî stosunek s≈Ç√≥w
  \item $r_{\text{init}}$ ‚Äî stosunek inicjacji rozm√≥w
  \item $r_{\text{rt}}$ ‚Äî stosunek czas√≥w odpowiedzi
\end{itemize}

% ---- 2.11 Burst Detection ----
\subsection{Burst Detection}

Identyfikacja nag≈Çych wzrost√≥w aktywno≈õci:
\begin{itemize}[nosep]
  \item \textbf{Pr√≥g:} 10+ wiadomo≈õci w~oknie 5 minut
  \item \textbf{Wynik:} Lista burst events z~timestampem, liczbƒÖ wiadomo≈õci, uczestnikami
\end{itemize}

% ---- 2.12 Viral Scores ----
\subsection{Viral Scores}

\begin{longtable}{p{4cm}p{6cm}p{3.5cm}}
\toprule
\textbf{Score} & \textbf{Formu≈Ça} & \textbf{Zakres} \\
\midrule
\endhead
Compatibility Score & Wa≈ºona kombinacja: reciprocity, balance, response consistency, shared activity & 0--100 \\
Interest Score & Per osoba: initiation rate, response speed, message length ratio, question ratio & 0--100 \\
Ghost Risk & Per osoba: response time trend, silence frequency, message gap growth & 0--100 \\
Delusion Score & Per osoba: |self-perception - actual behavior| across 5+ metrics & 0--100 \\
\bottomrule
\end{longtable}

% ---- 2.13 Threat Meters ----
\subsection{Threat Meters (Mierniki zagro≈ºe≈Ñ)}

4 kompozytowe metryki zagro≈ºe≈Ñ (0--100):

\begin{longtable}{p{3.5cm}p{6.5cm}p{3.5cm}}
\toprule
\textbf{Miernik} & \textbf{Sk≈Çadniki} & \textbf{Severity Labels} \\
\midrule
\endhead
Ghost Risk & Z~\texttt{viralScores.ghostRisk} & Niski / Umiarkowany / Podwy≈ºszony / Krytyczny \\
Codependency & Initiation imbalance, double-text rate, response time asymmetry & j.w. \\
Manipulation & CPS control + manipulation + passive aggression patterns & j.w. \\
Trust & Reciprocity (odwr√≥cony), response consistency, ghost frequency & j.w. \\
\bottomrule
\end{longtable}

% ---- 2.14 Damage Report ----
\subsection{Damage Report}

\begin{longtable}{p{4cm}p{6cm}p{3.5cm}}
\toprule
\textbf{Metryka} & \textbf{Formu≈Ça} & \textbf{Zakres} \\
\midrule
\endhead
Emotional Damage & $100 - \text{healthScore} + \text{sentiment asymmetry modifier}$ & 0--100\% \\
Communication Grade & Z~reciprocity: A($>80$), B($>60$), C($>40$), D($>20$), F($\leq 20$) & A--F \\
Repair Potential & Green flags count + response consistency + sentiment trend slope & 0--100\% \\
Therapy Needed & HS $< 40$ $\rightarrow$ TAK, $< 60$ $\rightarrow$ ZALECANE, else NIE & TAK/ZALECANE/NIE \\
\bottomrule
\end{longtable}

% ---- 2.15 Ranking Percentiles ----
\subsection{Ranking Percentiles (heurystyczne)}

Percentyle obliczane z~aproksymacji CDF rozk≈Çadu log-normalnego (Abramowitz \& Stegun):
\[
\Phi(z) \approx 1 - d \cdot t \cdot (a_1 + t(a_2 + t(a_3 + t(a_4 + t \cdot a_5))))
\]
gdzie $z = \frac{\ln(\text{value}) - \ln(\text{median})}{\sigma}$ i $t = \frac{1}{1 + 0.2316419|z|}$.

\begin{longtable}{p{4cm}p{3.5cm}p{2cm}p{4cm}}
\toprule
\textbf{Metryka} & \textbf{Mediana ref.} & \textbf{$\sigma$} & \textbf{Wynik} \\
\midrule
\endhead
Message Volume & 3000 wiad. & 1.2 & TOP X\% \\
Response Time & 480 000 ms (8 min) & 1.0 & TOP X\% (odwr√≥cony) \\
Ghost Frequency & 12h & 0.8 & TOP X\% \\
Asymmetry & 20 & 0.9 & TOP X\% \\
\bottomrule
\end{longtable}

Kolorowanie: \textcolor{ptyellow}{TOP 10\% = z≈Çoty}, TOP 25\% = srebrny, reszta = szary.

% ---- 2.16 Badges ----
\subsection{Odznaki (Badges)}

15 typ√≥w odznak automatycznie przyznawanych:

\begin{longtable}{p{3.5cm}p{7cm}p{3cm}}
\toprule
\textbf{Badge} & \textbf{Warunek} & \textbf{Emoji} \\
\midrule
\endhead
Night Owl & $>$20\% wiadomo≈õci 0:00--5:00 & ü¶â \\
Chatterbox & $>$10000 wiadomo≈õci & üí¨ \\
Double Texter & $>$15\% double-text rate & üì±üì± \\
Emoji King/Queen & $>$30\% wiadomo≈õci z~emoji & üëë \\
Ghost Buster & Szybki medianowy czas odpowiedzi & üëª \\
Essay Writer & ≈örednio $>$30 s≈Ç√≥w/wiadomo≈õƒá & üìù \\
Question Master & $>$20\% pyta≈Ñ & ‚ùì \\
Speed Demon & Mediana odpowiedzi $< 60$s & ‚ö° \\
Conversation Starter & $>$60\% inicjacji & üéØ \\
Media Lover & $>$20\% wiadomo≈õci z~mediami & üì∏ \\
Weekend Warrior & $>$40\% wiadomo≈õci w~weekend & üéâ \\
Early Bird & $>$20\% wiadomo≈õci 5:00--8:00 & üê¶ \\
Storyteller & Regularnie d≈Çugie wiadomo≈õci & üìñ \\
Reactor & Wysoki reaction rate & ‚ù§Ô∏è \\
Marathon Chatter & D≈Çugie sesje rozm√≥w & üèÉ \\
\bottomrule
\end{longtable}

% ---- 2.17 Catchphrases ----
\subsection{Catchphrases i Best Time to Text}

\begin{itemize}[nosep]
  \item \textbf{Catchphrases:} Top 5 unikalnych fraz per osoba, mierzonych czƒôstotliwo≈õciƒÖ i~unikalno≈õciƒÖ (fraza u≈ºywana nieproporcjonalnie czƒôsto przez jednƒÖ osobƒô)
  \item \textbf{Best Time to Text:} Optymalna godzina i~dzie≈Ñ tygodnia na podstawie najwy≈ºszego response rate i~najkr√≥tszego response time
\end{itemize}

% ---- 2.18 Cognitive Functions ----
\subsection{Cognitive Functions Clash}

Deterministyczne mapowanie MBTI $\rightarrow$ 4 funkcje kognitywne (Jung):

Ka≈ºdy z~16 typ√≥w MBTI mapowany na stos: \texttt{dominant}, \texttt{auxiliary}, \texttt{tertiary}, \texttt{inferior}. Przyk≈Çad:
\begin{itemize}[nosep]
  \item ENFJ: Fe (dom) ‚Üí Ni (aux) ‚Üí Se (ter) ‚Üí Ti (inf)
  \item INTP: Ti (dom) ‚Üí Ne (aux) ‚Üí Si (ter) ‚Üí Fe (inf)
\end{itemize}

\textbf{Clash analysis:} Por√≥wnanie dominant/auxiliary obu os√≥b ‚Äî clash score 0--100 per para funkcji z~opisem konfliktu.

% ---- 2.19 Gottman ----
\subsection{Czterech Je≈∫d≈∫c√≥w Gottmana}

Mapowanie z~CPS patterns + sygna≈Ç√≥w ilo≈õciowych:

\begin{longtable}{p{3cm}p{7cm}p{3.5cm}}
\toprule
\textbf{Je≈∫dziec} & \textbf{≈πr√≥d≈Ça} & \textbf{Severity} \\
\midrule
\endhead
Krytyka & CPS: kontrola + egocentryzm & none/mild/moderate/severe \\
Pogarda & CPS: manipulacja + asymetria odpowiedzi & j.w. \\
Defensywno≈õƒá & CPS: pasywna agresja + podejrzliwo≈õƒá & j.w. \\
Stonewalling & CPS: unikanie blisko≈õci + dystans emocjonalny + ghost risk & j.w. \\
\bottomrule
\end{longtable}

Risk level: Niski (0 aktywnych) ‚Üí Umiarkowany (1) ‚Üí Podwy≈ºszony (2) ‚Üí Wysoki (3) ‚Üí Krytyczny (4).

% ============================================================
% 3. ANALIZA AI (GEMINI API)
% ============================================================
\section{Analiza AI (Gemini API)}

Wieloprzebiegowa analiza psychologiczna z~wykorzystaniem modelu \texttt{gemini-3-flash-preview}. Ka≈ºdy przebieg otrzymuje 200--500 pr√≥bkowanych wiadomo≈õci. Wagi pr√≥bkowania: ostatnie 3 miesiƒÖce = 60\%.

\subsection{Pass 1 ‚Äî PrzeglƒÖd relacji}

\begin{longtable}{p{4.5cm}p{9cm}}
\toprule
\textbf{Pole} & \textbf{Opis} \\
\midrule
\endhead
tone & Og√≥lny ton rozmowy (formalny, swobodny, napiƒôty...) \\
communicationStyle & Styl komunikacji (bezpo≈õredni, pasywny, ≈ºartobliwy...) \\
relationshipType & Typ relacji (romantyczna, przyjacielska, rodzinna...) \\
dominantThemes & G≈Ç√≥wne tematy rozm√≥w \\
languageComplexity & Z≈Ço≈ºono≈õƒá jƒôzyka per osoba \\
\bottomrule
\end{longtable}

\subsection{Pass 2 ‚Äî Dynamika relacji}

\begin{longtable}{p{4.5cm}p{9cm}}
\toprule
\textbf{Pole} & \textbf{Opis} \\
\midrule
\endhead
powerBalance & Bilans w≈Çadzy w~relacji \\
conflictPatterns & Wzorce konflikt√≥w \\
intimacyLevel & Poziom intymno≈õci \\
emotionalLabor & Rozk≈Çad pracy emocjonalnej \\
redFlags[] & Czerwone flagi z~cytatami dowodowymi \\
greenFlags[] & Zielone flagi z~cytatami \\
turningPoints[] & Punkty zwrotne na timeline \\
\bottomrule
\end{longtable}

\subsection{Pass 3 ‚Äî Profile indywidualne}

Osobny profil dla ka≈ºdego uczestnika:

\begin{longtable}{p{4.5cm}p{9cm}}
\toprule
\textbf{Wymiar} & \textbf{Opis} \\
\midrule
\endhead
Big Five & 5 wymiar√≥w: openness, conscientiousness, extraversion, agreeableness, neuroticism (ka≈ºdy 0--100) \\
MBTI & 4-literowy typ + confidence (0--100) \\
Attachment Style & secure / anxious / avoidant / disorganized + opis \\
Love Languages & Ranking 5 jƒôzyk√≥w mi≈Ço≈õci (scored) \\
Communication Style Meters & directness, formality, emotionality, humor (0--100) \\
Tone Radar & warm, cold, sarcastic, supportive, aggressive, passive (0--100) \\
\bottomrule
\end{longtable}

\subsection{Pass 4 ‚Äî Synteza ko≈Ñcowa}

\begin{longtable}{p{4.5cm}p{9cm}}
\toprule
\textbf{Pole} & \textbf{Opis} \\
\midrule
\endhead
healthScore & Health Score 0--100 z~5 sub-scores \\
\quad communication & Sub-score: komunikacja & \\
\quad emotional & Sub-score: emocje & \\
\quad balance & Sub-score: balans & \\
\quad growth & Sub-score: rozw√≥j & \\
\quad stability & Sub-score: stabilno≈õƒá & \\
redFlags[] & Czerwone flagi z~evidence & \\
greenFlags[] & Zielone flagi z~evidence & \\
turningPoints[] & Kluczowe momenty na timeline & \\
recommendations & Rekomendacje dla relacji & \\
predictions[] & Prognozy AI (patrz ni≈ºej) & \\
\bottomrule
\end{longtable}

\subsubsection{AI Predictions}
Ka≈ºda predykcja zawiera:
\begin{itemize}[nosep]
  \item \texttt{prediction:} Tre≈õƒá prognozy (tekst)
  \item \texttt{confidence:} Pewno≈õƒá 0--100\%
  \item \texttt{timeframe:} Horyzont czasowy (np. ``Q1 2025'')
  \item \texttt{basis:} Uzasadnienie na podstawie trend√≥w
\end{itemize}
Disclaimer: \textit{Predykcje AI oparte na trendach ‚Äî nie stanowiƒÖ pewno≈õci.}

% ============================================================
% 4. MODU≈ÅY INTERAKTYWNE
% ============================================================
\section{Modu≈Çy interaktywne (AI-powered)}

\subsection{Enhanced Roast}
Psychologiczny roast z~pe≈Çnym kontekstem Pass 1--4. Endpoint: \texttt{/api/analyze} (roast pass w~g≈Ç√≥wnym SSE).

\subsection{Stand-Up Comedy Roast}
7-aktowa rozmowa w~stylu stand-up comedy. Generuje PDF do pobrania.
\begin{itemize}[nosep]
  \item Endpoint: \texttt{POST /api/analyze/standup}
  \item Streaming: SSE z~7 aktami
  \item Export: jsPDF client-side
\end{itemize}

\subsection{CPS Screener (Communication Pattern Screening)}
63 pytania analizujƒÖce 10 wzorc√≥w komunikacyjnych:

\begin{longtable}{p{0.5cm}p{5cm}p{2.5cm}p{2.5cm}}
\toprule
\textbf{\#} & \textbf{Wzorzec} & \textbf{Pyta≈Ñ} & \textbf{Pr√≥g} \\
\midrule
\endhead
1 & Unikanie blisko≈õci & 6 & $\geq 50\%$ \\
2 & Nadmierna kontrola & 7 & $\geq 50\%$ \\
3 & Kontrola i~perfekcjonizm & 6 & $\geq 50\%$ \\
4 & Podejrzliwo≈õƒá i~nieufno≈õƒá & 7 & $\geq 50\%$ \\
5 & Egocentryzm komunikacyjny & 6 & $\geq 50\%$ \\
6 & Intensywno≈õƒá emocjonalna & 7 & $\geq 50\%$ \\
7 & Dramatyzacja i~histrionizm & 6 & $\geq 50\%$ \\
8 & Manipulacja i~brak empatii & 6 & $\geq 50\%$ \\
9 & Emocjonalny dystans & 6 & $\geq 50\%$ \\
10 & Pasywna agresja & 6 & $\geq 50\%$ \\
\bottomrule
\end{longtable}

\subsection{Subtext Decoder (Translator Podtekst√≥w)}
AI dekoduje ukryte znaczenia w~wiadomo≈õciach.
\begin{itemize}[nosep]
  \item Kontekst: 30+ wiadomo≈õci na wymianƒô
  \item Kategorie: deflection, hidden\_anger, seeking\_validation, power\_move, genuine, testing, guilt\_trip, passive\_aggressive, love\_signal, insecurity, distancing, humor\_shield
  \item Output: orygina≈Ç ‚Üí dekodowana wiadomo≈õƒá + confidence + kategoria
  \item Deception Score per osoba (0--100\%)
\end{itemize}

\subsection{Court Trial (Tw√≥j Chat w~SƒÖdzie)}
AI prowadzi rozprawƒô sƒÖdowƒÖ z~pe≈Çnym procesem:
\begin{itemize}[nosep]
  \item Akt oskar≈ºenia z~konkretnymi zarzutami
  \item Mowa oskar≈ºycielska z~cytatami z~rozmowy
  \item Mowa obro≈Ñcza z~okoliczno≈õciami ≈ÇagodzƒÖcymi
  \item Wyrok: \texttt{winny} / \texttt{niewinny} / \texttt{warunkowo}
  \item Kara (kreatywna, dopasowana do ``przestƒôpstwa'')
  \item Share card: Mugshot Card z~sygnaturƒÖ sprawy
\end{itemize}

\subsection{Dating Profile Generator}
Szczery profil randkowy na podstawie zachowa≈Ñ tekstowych:
\begin{itemize}[nosep]
  \item Bio na podstawie stylu komunikacji
  \item Age Vibe (mentalny wiek)
  \item Statystyki kluczowe (szybko≈õƒá reakcji, inicjatywa, cierpliwo≈õƒá)
  \item Prompts \& Answers (w~stylu Hinge)
  \item Red Flags + Green Flags
  \item Overall Rating
  \item Share card: Gazeta Podtekstowa (styl og≈Çoszenia matrymonialnego)
\end{itemize}

\subsection{Reply Simulator}
Symulacja odpowiedzi w~g≈Çosie partnera:
\begin{itemize}[nosep]
  \item U≈ºytkownik wpisuje wiadomo≈õƒá
  \item AI odpowiada w~stylu wybranego uczestnika
  \item Bazuje na: stylu komunikacji, tonie, czƒôstych frazach, response patterns
\end{itemize}

\subsection{Delusion Quiz}
Test samo≈õwiadomo≈õci ‚Äî por√≥wnanie percepcji z~rzeczywisto≈õciƒÖ:
\begin{itemize}[nosep]
  \item Seria pyta≈Ñ o~w≈Çasne zachowania w~rozmowie
  \item Odpowiedzi por√≥wnywane z~rzeczywistymi danymi ilo≈õciowymi
  \item \textbf{Delusion Index:} 0--100 (im wy≈ºej, tym wiƒôksza rozbie≈ºno≈õƒá)
  \item Kategorie: Low Delusion ($< 30$), Moderate ($30$--$60$), High ($> 60$)
\end{itemize}

\subsection{Couple's Quiz}
Quiz wiedzy o~partnerze (osobna trasa \texttt{/couple}):
\begin{itemize}[nosep]
  \item Pytania generowane z~danych ilo≈õciowych
  \item Odpowiedzi weryfikowane z~rzeczywistymi statystykami
  \item Wynik kompatybilno≈õci
\end{itemize}

% ============================================================
% 5. SHARE CARDS
% ============================================================
\section{Share Cards (24+ typ√≥w)}

Karty do udostƒôpniania w~mediach spo≈Çeczno≈õciowych, eksportowane jako PNG.

\begin{longtable}{p{4.5cm}p{6cm}p{3cm}}
\toprule
\textbf{Karta} & \textbf{Zawarto≈õƒá} & \textbf{Styl} \\
\midrule
\endhead
StatsCard & Kluczowe statystyki rozmowy & Ciemny, numeryczny \\
PersonalityCard & Profil osobowo≈õci & Gradient \\
PersonalityPassportCard & Paszport osobowo≈õci & Paszportowy \\
ReceiptCard & Paragon z~relacji & Paragonowy \\
VersusCard / V2 & Por√≥wnanie 1v1 & Splitscreen \\
CompatibilityCardV2 & Wynik kompatybilno≈õci & Gradientowy \\
RedFlagCard & Czerwone flagi & Czerwono-czarny \\
GhostForecastCard & Prognoza ghostingu & Mglisty \\
HealthScoreCard & Health Score & Gauge \\
MBTICard & Typ MBTI & Kolorowy \\
BadgesCard & Odznaki & Grid \\
FlagsCard & Red + Green Flags & Dwukolorowy \\
LabelCard & Etykieta relacji & Minimalistyczny \\
ScoresCard & Viral Scores & Neonowy \\
SubtextCard & Dekodowane wiadomo≈õci & Matrix/wojskowy \\
MugshotCard & Mugshot z~wyroku & Policyjny \\
DatingProfileCard & Profil randkowy & Gazetowy \\
DelusionCard & Wynik Delusion Quiz & Brutalny \\
SimulatorCard & Symulacja odpowiedzi & Chatowy \\
CoupleQuizCard & Wynik Couple's Quiz & Romantyczny \\
CPSCard & Rentgen komunikacji & Medyczny/RTG \\
\bottomrule
\end{longtable}

Ka≈ºda karta: 360px szeroko≈õci, minimalna wysoko≈õƒá 640px, eksport do PNG via \texttt{html-to-image}.

% ============================================================
% 6. STORY MODE (WRAPPED)
% ============================================================
\section{Story Mode (Wrapped)}

12-scenowa prezentacja w~stylu Spotify Wrapped:
\begin{enumerate}[nosep]
  \item Intro z~animacjƒÖ
  \item Kluczowe liczby (total messages, days, words)
  \item Osobowo≈õci uczestnik√≥w
  \item MBTI por√≥wnanie
  \item Versus stats
  \item Red flags parade
  \item Roast highlight
  \item Court verdict
  \item Interactive recap
  \item Stand-Up fragment
  \item Heatmap visual
  \item Wrapped summary
\end{enumerate}

Animacje: Framer Motion, auto-play z~mo≈ºliwo≈õciƒÖ nawigacji.

% ============================================================
% 7. SERVER VIEW
% ============================================================
\section{Server View (5+ uczestnik√≥w)}

Aktywacja: \texttt{isGroup \&\& participants.length > 4}

Dodatkowe komponenty w~trybie grupowym:
\begin{itemize}[nosep]
  \item \textbf{PersonNavigator:} Nawigacja miƒôdzy profilami (20-kolorowa paleta)
  \item \textbf{PersonProfile:} Indywidualny profil per osoba
  \item \textbf{ServerLeaderboard:} Ranking uczestnik√≥w
  \item \textbf{PairwiseComparison:} Por√≥wnanie 1v1 dowolnej pary
  \item \textbf{ServerOverview:} PrzeglƒÖd statystyk grupowych
\end{itemize}

\textit{W~trybie grupowym ukryte:} Viral Scores, Ghost Forecast, Delusion Quiz.

% ============================================================
% 8. DISCORD BOT
% ============================================================
\section{Discord Bot (11 komend)}

Bot Discord z~11 komendami slash. Infra: HTTP interactions (Ed25519 verification), in-memory channel cache (1h TTL, 50 entries LRU).

\begin{longtable}{p{3cm}p{7cm}p{3.5cm}}
\toprule
\textbf{Komenda} & \textbf{Opis} & \textbf{Parametry} \\
\midrule
\endhead
/stats & Statystyki kana≈Çu & limit? \\
/versus & Por√≥wnanie 2 os√≥b & user1, user2 \\
/whosimps & Kto simpi na kogo & limit? \\
/ghostcheck & Kto ghostuje & limit? \\
/besttime & Najlepszy czas na pisanie & -- \\
/catchphrase & Catchphrases uczestnik√≥w & -- \\
/emoji & Top emoji per osoba & -- \\
/nightowl & Nocne marki & -- \\
/ranking & Ranking aktywno≈õci & -- \\
/roast & AI roast kana≈Çu & target? \\
/personality & AI profil osobowo≈õci & target \\
\bottomrule
\end{longtable}

% ============================================================
% 9. EKSPORT
% ============================================================
\section{Eksport i~udostƒôpnianie}

\begin{itemize}[nosep]
  \item \textbf{PDF (standard):} Pe≈Çny raport analizy z~wykresami via jsPDF
  \item \textbf{PDF (Stand-Up):} 7-aktowa komedia w~PDF
  \item \textbf{Share Cards:} 24+ typ√≥w kart PNG
  \item \textbf{Web Share API:} Natywne udostƒôpnianie na mobile
  \item \textbf{Public Share Links:} Zakodowane linki z~podsumowaniem (bez surowych wiadomo≈õci)
\end{itemize}

% ============================================================
% 10. API
% ============================================================
\section{API Endpoints}

\begin{longtable}{p{5cm}p{2cm}p{4cm}p{2.5cm}}
\toprule
\textbf{Endpoint} & \textbf{Method} & \textbf{Opis} & \textbf{Rate Limit} \\
\midrule
\endhead
/api/analyze & POST & 4-pass AI analysis (SSE) & 5/10min \\
/api/analyze/enhanced-roast & POST & Enhanced roast (SSE) & 5/10min \\
/api/analyze/standup & POST & Stand-Up 7 acts (SSE) & 5/10min \\
/api/analyze/cps & POST & CPS 63 questions (SSE) & 5/10min \\
/api/analyze/subtext & POST & Subtext Decoder (SSE) & 5/10min \\
/api/analyze/court & POST & Court Trial (SSE) & 5/10min \\
/api/analyze/dating-profile & POST & Dating Profile (SSE) & 5/10min \\
/api/analyze/simulate & POST & Reply Simulator (SSE) & 5/10min \\
/api/analyze/image & POST & Image generation & 10/10min \\
/api/discord/fetch-messages & POST & Discord message fetch (SSE) & 3/10min \\
/api/health & GET & Health check & brak \\
\bottomrule
\end{longtable}

% ============================================================
% 11. PRYWATNO≈öƒÜ
% ============================================================
\section{Prywatno≈õƒá i~bezpiecze≈Ñstwo}

\begin{enumerate}[nosep]
  \item Surowe wiadomo≈õci przetwarzane client-side ‚Äî nigdy nie przesy≈Çane na serwer
  \item Tylko 200--500 pr√≥bkowanych wiadomo≈õci wysy≈Çanych do Gemini API per pass
  \item Brak tre≈õci rozm√≥w w~logach serwera
  \item Wszystkie dane w~przeglƒÖdarce (IndexedDB / localStorage)
  \item GDPR-friendly ‚Äî u≈ºytkownik mo≈ºe usunƒÖƒá dane lokalnie
  \item Rate limiting na wszystkich endpointach API
  \item CSP headers (Content Security Policy)
\end{enumerate}

% ============================================================
% FOOTER
% ============================================================
\vfill
\begin{center}
\rule{0.5\textwidth}{0.4pt}

\vspace{0.5cm}
{\small\textcolor{gray}{PodTeksT ‚Äî odkryj to, co kryje siƒô miƒôdzy wierszami}}

{\footnotesize\textcolor{gray}{Wygenerowano: \today{} | Claude Opus 4.6 | Faza 24}}
\end{center}

\end{document}
